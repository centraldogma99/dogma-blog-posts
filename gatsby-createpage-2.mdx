---
title: 'Gatsby - ë™ì ìœ¼ë¡œ í˜ì´ì§€ ë§Œë“¤ê¸°(Node createPages API)'
subtitle: 'createPages APIë¥¼ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ ë¼ìš°íŒ…í•˜ê¸°.'
date: '2022-01-26'
draft: false
tag:
  - blog
  - gatsby
  - javascript
  - frontend
  - headless
  - react
  - graphql
  - html
---

ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Gatsby node APIì˜ ì¼ë¶€ì¸ `createPages`ë¥¼ í™œìš©í•˜ì—¬ í˜ì´ì§€ë¥¼ ë§Œë“¤ê³  ë¼ìš°íŒ…í•˜ëŠ” ê³¼ì •ì„ ì„¤ëª…í•œë‹¤.

[Gatsby - ë™ì ìœ¼ë¡œ í˜ì´ì§€ ë§Œë“¤ê¸°(File system route API)](https://blog.dogmadevs.com/posts/gatsby-createpage) ê¸€ê³¼ ê°™ì´ mdx í˜•íƒœì˜ í¬ìŠ¤íŠ¸ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ë™ì ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ë§Œë“œëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•  ê²ƒì¸ë°, ë‹¤ë§Œ ì´ë²ˆì—ëŠ” `createPages` APIë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•  ê²ƒì´ë‹¤.

> ### ğŸ’¡ ì‹œì‘í•˜ê¸° ì „ì—
>
> ë§Œì•½ File system route APIë¥¼ ì‚¬ìš©í•œ í˜ì´ì§€ ë§Œë“¤ê¸°ì— ëŒ€í•´ ì˜ ëª¨ë¥¸ë‹¤ë©´ [Gatsby - ë™ì ìœ¼ë¡œ í˜ì´ì§€ ë§Œë“¤ê¸°(File system route API)](https://blog.dogmadevs.com/posts/gatsby-createpage) ë¥¼ í•œë²ˆ ì½ì–´ ë³´ê³  ì˜¤ëŠ” ê²ƒì´ ì¢‹ë‹¤.  
> Node APIê°€ ì¢€ë” low-level ì´ë¯€ë¡œ, ê°€ëŠ¥í•˜ë‹¤ë©´ File system route APIë¥¼ ì‚¬ìš©í•˜ëŠ” ìª½ì´ ì½”ë“œê°€ ë” ê¹”ë”í•  ê²ƒì´ë‹¤.

í˜„ì¬ ìƒí™©ê³¼ êµ¬í˜„í•  ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

> `src/posts` ë””ë ‰í† ë¦¬ì— í¬ìŠ¤íŠ¸ë“¤ì´ ë‹¤ìŒê³¼ ê°™ì´ ê°ê° mdx ë¬¸ì„œë¡œ ì €ì¥ë˜ì–´ ìˆë‹¤.
>
> `src/posts`  
> â”” hello-world.mdx  
> â”” first-post.mdx  
> â”” another-post.mdx
>
> ê°ê°ì˜ íŒŒì¼ ì´ë¦„ì´ ì ‘ì† ì£¼ì†Œê°€ ë˜ë„ë¡ ë§Œë“ ë‹¤.  
> ì˜ˆë¡œ, `hello-world.mdx` íŒŒì¼ì€ `/posts/hello-world` ê²½ë¡œë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ë§Œë“ ë‹¤.
>
> `gatsby-plugin-mdx` í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ mdx íŒŒì¼ë“¤ì„ ë“¤ì—¬ì˜¨ë‹¤.

## Gatsby Node API

Gatsby Node APIëŠ” í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ë§Œë“¤ê±°ë‚˜, GraphQLì— ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜, ë¹Œë“œ ë¼ì´í”„ì‚¬ì´í´ ì¤‘ì˜ ì´ë²¤íŠ¸ì— ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•˜ëŠ” ë“±ì˜ ì—¬ëŸ¬ APIë“¤ì„ ì œê³µí•œë‹¤.

ìš°ë¦¬ëŠ” ì—¬ëŸ¬ ê°€ì§€ API ì¤‘ì—ì„œ `createPages` APIë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.  
ë‹¤ë¥¸ APIë“¤ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ë ¤ë©´ [Gatsby Node APIs](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/) ë¥¼ ì°¸ì¡°í•˜ë©´ ëœë‹¤.

_Gatsby Node APIëŠ” **í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œì˜ `gatsby-node.js` íŒŒì¼**ì— êµ¬í˜„ë˜ì–´ì•¼ í•œë‹¤._ `gatsby-node.js`ì€ ë¹Œë“œ ì¤‘ì— ë‹¨ í•œ ë²ˆ ì‹¤í–‰ëœë‹¤.

## createPages

í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•œë‹¤.

`createPages`ëŠ” ë…¸ë“œì™€ GraphQL ìŠ¤í‚¤ë§ˆì˜ ìƒì„±, ë°ì´í„°ë“¤ì˜ sourcingì´ ì™„ë£Œëœ í›„ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì—, ì´ íŒŒì¼ì—ì„œ í˜ì´ì§€ë“¤ì„ ë§Œë“¤ ë°ì´í„°ë“¤ì„ ìš”ì²­í•  ìˆ˜ ìˆë‹¤.

`createPages`ì˜ íŒŒë¼ë¯¸í„°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- Destructured ì˜¤ë¸Œì íŠ¸
  - `actions`
    - `createPage`
    - ... ì™¸ ì—¬ëŸ¬ ê°€ì§€
  - `graphql`
  - `reporter`

ê°ê°ì˜ íŒŒë¼ë¯¸í„°ê°€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ë¥¼ ë§ë¡œ ì„¤ëª…í•˜ê¸°ë³´ë‹¤, êµ¬í˜„ëœ ì½”ë“œë¥¼ ë³´ëŠ” ê²ƒì´ ì´í•´ê°€ ë¹ ë¥¼ ê²ƒì´ë‹¤.

`gatsby-node.js` íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í•œë‹¤. `gatsby-node.js` íŒŒì¼ì€ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜í•´ì•¼ í•œë‹¤.

```javascript
const path = require(`path`);

exports.createPages = ({ graphql, actions }) => {
  const { createPage } = actions;
  // í¬ìŠ¤íŠ¸ë“¤ì„ ë Œë”ë§í•  í…œí”Œë¦¿ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.
  const postTemplate = path.resolve(`src/components/postTemplate.jsx`);

  // mdx íŒŒì¼ë“¤ì˜ id/slug ê°’ì„ ë°›ì•„ì˜¨ë‹¤.
  const { data } = await graphql(`
    query {
      allMdx {
        id
        slug
      }
    }
  `);

  // ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ createPageë¥¼ í˜¸ì¶œí•œë‹¤.
  data.allMdx.nodes.forEach(node => {
    createPage({
      // "/post/hello-world" ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ë Œë”ë§ë˜ë„ë¡
      // ì ‘ê·¼ ê²½ë¡œë¥¼ í…œí”Œë¦¿ ë¦¬í„°ëŸ´ì„ ì‚¬ìš©í•´ ì •ì˜í•˜ì˜€ë‹¤.
      path: `/posts/${node.slug}`,
      // í…œí”Œë¦¿ ì»´í¬ë„ŒíŠ¸ì´ë‹¤.
      component: postTemplate,
      // ì»´í¬ë„ŒíŠ¸ì— ë„˜ê²¨ì¤„ íŒŒë¼ë¯¸í„°ë“¤ì´ë‹¤.
      context: {
        id: node.id,
      },
    });
  });
};
```

í…œí”Œë¦¿ íŒŒì¼(`src/components/postTemplate.jsx`)ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```javascript
import * as React from 'react';
import { graphql } from 'gatsby';
import { MDXRenderer } from 'gatsby-plugin-mdx';

const BlogPost = ({ data }) => {
  <div>
    <h1>{data.mdx.frontmatter.title}</h1>
    <p>{data.mdx.frontmatter.date} ì— ì‘ì„±</p>
    <MDXRenderer>{data.mdx.body}</MDXRenderer>
  </div>;
};

export const query = graphql`
  query ($id: String) {
    mdx(id: { eq: $id }) {
      frontmatter {
        title
        date(formatString: "MMMM D, YYYY")
      }
      body
    }
  }
`;

export default BlogPost;
```

í˜ì´ì§€ ì¿¼ë¦¬ì—ì„œ `id` ê°’ì„ ë°›ì•„ mdx ë¬¸ì„œë¥¼ ì¿¼ë¦¬í•˜ê³  ê·¸ ê²°ê³¼ ë°ì´í„°ë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¶œë ¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

`id` ê°’ì€ ìœ„ì˜ `gatsby-node.js` ì½”ë“œì—ì„œ `createPage`ì˜ `context` í”„ë¼í¼í‹°ë¥¼ í†µí•´ ì „ë‹¬ë˜ê³  ìˆë‹¤(ë°‘ì—ì„œ 6ë²ˆì§¸ ì¤„).

## ì°¸ê³ ìë£Œ

[Gatsby Node APIs](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/)  
[Gatsby - ë™ì ìœ¼ë¡œ í˜ì´ì§€ ë§Œë“¤ê¸°(w/ File system route API)](https://blog.dogmadevs.com/posts/gatsby-createpage)  
ì´í•´ì— ë„ì›€ì´ ë ê¹Œ í•˜ì—¬ ì´ ë¸”ë¡œê·¸ ì†ŒìŠ¤ì½”ë“œì˜ [gatsby-node.js](https://github.com/centraldogma99/dogma-blog/blob/main/gatsby-node.js)ì™€ í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ [PostTemplate.tsx](https://github.com/centraldogma99/dogma-blog/blob/main/src/components/PostTemplate.tsx)ì˜ ì½”ë“œë¥¼ ë§ë¶™ì…ë‹ˆë‹¤(ë§í¬ëŠ” Github ë ˆí¬ì§€í† ë¦¬).

### gatsby-node.js

```javascript
const path = require('path');

const initializePostPages = async (createPage, graphql) => {
  const template = path.resolve('./src/components/PostTemplate.tsx');
  const { data } = await graphql(`
    query {
      allFile(
        filter: {
          sourceInstanceName: { eq: "post" }
          childMdx: { frontmatter: { draft: { eq: false } } }
        }
        sort: { fields: childMdx___frontmatter___date, order: DESC }
      ) {
        nodes {
          childMdx {
            id
            slug
          }
        }
      }
    }
  `);

  data.allFile.nodes.forEach(node => {
    createPage({
      path: `/posts/${node.childMdx.slug}`,
      component: template,
      context: {
        id: node.childMdx.id,
      },
    });
  });
};

const initializeTagPages = async (createPage, graphql) => {
  const { data } = await graphql(`
    {
      allMdx(filter: { frontmatter: { draft: { eq: false } } }) {
        group(field: frontmatter___tag) {
          tag: fieldValue
        }
      }
    }
  `);
  const tags = data.allMdx.group.reduce((a, b) => {
    if (a.length) {
      return [...a, b.tag];
    } else {
      return [a.tag, b.tag];
    }
  });

  const tagTemplate = path.resolve('./src/components/tagTemplate.tsx');

  tags.forEach(tag =>
    createPage({
      path: `/tags/${tag}`,
      component: tagTemplate,
      context: {
        tag: tag,
      },
    }),
  );
};

const initializeMainPage = async createPage => {
  const tagTemplate = path.resolve('./src/components/tagTemplate.tsx');

  createPage({
    path: `/`,
    component: tagTemplate,
  });
};

// Main function
exports.createPages = ({ graphql, actions }) => {
  const { createPage } = actions;

  initializePostPages(createPage, graphql);
  initializeTagPages(createPage, graphql);
  initializeMainPage(createPage);
};
```

### PostTemplate.tsx

```javascript
import { graphql } from 'gatsby';
import React, { useEffect } from 'react';
import Frame from './Frame';
import { MDXRenderer } from 'gatsby-plugin-mdx';
import TagBtn from './TagBtn';
import { Divider } from '@mui/material';
import hljs from 'highlight.js/lib/common';
import 'highlight.js/styles/github.css';
import { TagButtonsContainer } from '../styles/tags';
import {
  subtitle,
  descContainer,
  articleBodyContainer,
} from '../styles/PostTemplate';

const PostTemplate = ({ data }) => {
  const { body, frontmatter } = data.mdx;

  useEffect(() => {
    hljs.highlightAll();
  }, []);

  return (
    <Frame title={frontmatter.title}>
      <div className={descContainer}>
        <p className={subtitle}>{frontmatter.subtitle}</p>
        <p>{frontmatter.date} ì‘ì„±</p>
        <TagButtonsContainer>
          {frontmatter.tag.sort().map(tag => (
            <TagBtn tag={tag} key={tag} />
          ))}
        </TagButtonsContainer>
      </div>
      <Divider />
      <div className={articleBodyContainer}>
        <MDXRenderer>{body}</MDXRenderer>
      </div>
    </Frame>
  );
};

export const query = graphql`
  query ($id: String) {
    mdx(id: { eq: $id }) {
      body
      frontmatter {
        date(formatString: "YYYY-MM-DD")
        title
        subtitle
        tag
        draft
      }
    }
  }
`;

export default PostTemplate;
```
